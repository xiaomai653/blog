---
title: Java线程基础
date: 2022-04-22 16:15:54
permalink: /pages/20b9df/
categories:
  - 学习资料
  - Java
  - 并发
tags:
  - 
---

## 线程使用方式
### Runnable 接口
需要实现 run() 方法。  
通过 Thread 调用 start() 方法来启动线程。
```java
public class MyRunnable implements Runnable {
    public void run() {
        // ...
    }
}
```
```java
public class Test {
    public static void main(String[] args) {
        MyRunnable instance = new MyRunnable();
        Thread thread = new Thread(instance);
        thread.start();
    }
}
```

### 继承 Thread 类
同样也是需要实现 run() 方法，因为 Thread 类也实现了 Runable 接口。  
当调用 start() 方法启动一个线程时，虚拟机会将该线程放入就绪队列中等待被调度，当一个线程被调度时会执行该线程的 run() 方法。
```java
public class MyThread extends Thread {
    public void run() {
        // ...
    }
}
```
```java
public class Test{
    public static void main(String[] args) {
        MyThread mt = new MyThread();
        mt.start();
    }
}
```
### Callable 接口
与 Runnable 相比，Callable 可以有返回值，返回值通过 FutureTask 进行封装。
```java
public class MyCallable implements Callable<Integer> {
    public Integer call() {
        return 123;
    }
}
```
```java
public class Test{
    public static void main(String[] args) throws ExecutionException, InterruptedException {
        MyCallable mc = new MyCallable();
        FutureTask<Integer> ft = new FutureTask<>(mc);
        Thread thread = new Thread(ft);
        thread.start();
        System.out.println(ft.get());
    }
}
```

## 线程状态
### 新建(New)
使用 new 关键字和 Thread 类或其子类建立一个线程对象后，该线程对象就处于新建状态。它保持这个状态直到程序 start() 这个线程。

### 可运行(Runnable)
当线程对象调用了start()方法之后，该线程就进入就绪状态。就绪状态的线程处于就绪队列中，要等待JVM里线程调度器的调度。
可能正在运行，也可能正在等待 CPU 时间片。

包含了操作系统线程状态中的 Running 和 Ready。

### 阻塞(Blocking)
等待获取一个排它锁，如果其线程释放了锁就会结束此状态。

### 无限期等待(Waiting)
等待其它线程显式地唤醒，否则不会被分配 CPU 时间片。

### 限期等待(Timed Waiting)
无需等待其它线程显式地唤醒，在一定时间之后会被系统自动唤醒。

### 死亡(Terminated)
可以是线程结束任务之后自己结束，或者产生了异常而结束。

## 